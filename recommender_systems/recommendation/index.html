

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>19. Recommender Systems &#8212; AnIML: Another Introduction to Machine Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "animlbook/AnIML");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "preferred-color-scheme");
    script.setAttribute("label", "üí¨ Comments");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="../../_static/script.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmin": ["\\underset{#1}{\\operatorname{argmin}}", 1], "argmax": ["\\underset{#1}{\\operatorname{argmax}}", 1], "abs": ["\\lvert #1 \\rvert", 1], "indicator": ["\\mathbb{\\unicode{x1D7D9}}\\left\\{ #1 \\right\\}", 1], "norm": ["\\lVert #1 \\rVert", 1]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'recommender_systems/recommendation/index';</script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="18. Dimensionality Reduction (coming soon)" href="../pca/index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>


  <div class="bd-header-announcement container-fluid bd-header-announcement">
    <div class="bd-header-announcement__content">This book is still under construction. We appreciate your patience as we get it completed. Feedback is welcome!</div>
  </div>

  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro/index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro/index.html">
                    <i class="fas fa-hand-sparkles fa-fw"></i> Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Regression</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../regression/linear_regression/index.html">1. <i class="fas fa-book fa-fw"></i> Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../regression/assessing_performance/index.html">2. <i class="fas fa-book fa-fw"></i> Assessing Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../regression/ridge/index.html">3. <i class="fas fa-book fa-fw"></i> Ridge Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../regression/lasso/index.html">4. <i class="fas fa-book fa-fw"></i> Feature Selection and LASSO Regularization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Classification</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../classification/intro/index.html">5. <i class="fas fa-book fa-fw"></i> Classification Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../classification/logistic_regression/index.html">6. <i class="fas fa-book fa-fw"></i> Logistic Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../classification/bias_fairness/index.html">7. <i class="fas fa-book fa-fw"></i> Bias and Fairness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../classification/naive_bayes/index.html">8. <i class="fas fa-book fa-fw"></i> Na√Øve Bayes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../classification/trees/index.html">9. <i class="fas fa-book fa-fw"></i> Decision Trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../classification/ensembles/index.html">10. <i class="fas fa-book fa-fw"></i> Ensemble Methods</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Deep Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../deep_learning/intro/index.html">11. <i class="fas fa-book fa-fw"></i> Neural Networks (coming soon)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deep_learning/conv_nets/index.html">12. <i class="fas fa-book fa-fw"></i> Convolutional Neural Networks (coming soon)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Document Retrieval / Local Methods</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../document_retrieval/knn/index.html">13. <i class="fas fa-book fa-fw"></i> Introduction, Precision/Recall, k-Nearest Neighbors (coming soon)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../document_retrieval/kernels/index.html">14. <i class="fas fa-book fa-fw"></i> Kernel Methods (coming soon)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../document_retrieval/lsh/index.html">15. <i class="fas fa-book fa-fw"></i> Locality Sensitive Hashing (coming soon)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../document_retrieval/clustering/index.html">16. <i class="fas fa-book fa-fw"></i> Clustering &amp; k-means (coming soon)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../document_retrieval/other_clustering/index.html">17. <i class="fas fa-book fa-fw"></i> Hierarchical Clustering (coming soon)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Recommender Systems</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../pca/index.html">18. <i class="fas fa-book fa-fw"></i> Dimensionality Reduction (coming soon)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">19. <i class="fas fa-book fa-fw"></i> Recommender Systems</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/animlbook/AnIML/main?urlpath=lab/tree/book_source/source/recommender_systems/recommendation/index.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/animlbook/AnIML" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/animlbook/AnIML/edit/main/book_source/source/recommender_systems/recommendation/index.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/animlbook/AnIML/issues/new?title=Issue%20on%20page%20%2Frecommender_systems/recommendation/index.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/recommender_systems/recommendation/index.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../../_sources/recommender_systems/recommendation/index.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><i class="fas fa-book fa-fw"></i> Recommender Systems</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recommendation-framework">19.1. Recommendation Framework</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-1-popularity-recommendations">19.2. Approach 1: Popularity Recommendations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-2-nearest-users">19.3. Approach 2: Nearest Users</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-3-people-who-bought-this-also-bought">19.4. Approach 3: ‚ÄúPeople who bought this also bought‚Ä¶‚Äù</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-4-feature-based-approaches">19.5. Approach 4: Feature-Based Approaches</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-5-matrix-factorization">19.6. Approach 5: Matrix Factorization</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="i-class-fas-fa-book-fa-fw-i-recommender-systems">
<h1><span class="section-number">19. </span><i class="fas fa-book fa-fw"></i> Recommender Systems<a class="headerlink" href="#i-class-fas-fa-book-fa-fw-i-recommender-systems" title="Permalink to this heading">#</a></h1>
<p>As the final main module of our book, we want to explore the ever-present concept of <strong>recommender systems</strong>. Recommender systems are quite a broad set of applications of machine learning, and there are no shortage of examples you are likely familiar with in your experience online. These include, but are no way limited to:</p>
<ul class="simple">
<li><p>Netflix recommends movies/shows that it think you will watch.</p></li>
<li><p>Spotify recommends artist or songs similar to ones you‚Äôve listened to before. They even build playlists such as ‚ÄúDiscover Weekly‚Äù to accumulate many of of these recommendations in a single playlist.</p></li>
<li><p>Youtube recommends videos on your home page for you to watch, as well as set of videos for you to watch next related to the content you are currently watching.</p></li>
<li><p>Social media companies like TikTok, Twitter, Facebook are constantly recommending you posts or media that they think you will like. Additionally, they recommend ads personalized to you based on the content you frequently interact with.</p></li>
<li><p>Online stores such as Amazon recommend products they think you will purchase.</p></li>
<li><p>Search engines serve you tailored ads based on your current search, and your search history.</p></li>
</ul>
<p>As you can see, this concept of ‚Äúrecommendation‚Äù is quite broad topic and can be used in quite a few applications. However, a lot of these problems can be framed as special cases of the same underlying recommendation problem.</p>
<p>We will explore a wide set of possible algorithms for this recommendation framework in this chapter, and importantly, discuss the pros and cons of the various approaches based on their designs. For each of the approaches we outline, we will include a couple tags for the approach that we will define in detail later in the chapter, so you can ignore those for now on your first read.</p>
<section id="recommendation-framework">
<h2><span class="section-number">19.1. </span>Recommendation Framework<a class="headerlink" href="#recommendation-framework" title="Permalink to this heading">#</a></h2>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<figure class="align-default" id="id1">
<img alt="Netflix rating buttons (thumbs down, thumbs up, two thumbs up)" src="../../_images/netflix.png" />
<figcaption>
<p><span class="caption-number">Fig. 19.1 </span><span class="caption-text">Netflix rating buttons</span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</aside>
<p>Most recommendation problems can be framed in a similar framework of a <strong>user-item interaction matrix</strong>. We usually consider a system with <span class="math notranslate nohighlight">\(n\)</span> users and <span class="math notranslate nohighlight">\(m\)</span> items. In many settings we assume there are far more users than items (<span class="math notranslate nohighlight">\(n \gg m\)</span>). For example, in 2023, Youtube had approximately 2.6 billion user and 800 million videos (<a class="reference external" href="https://www.globalmediainsight.com/blog/youtube-users-statistics/">source</a>).</p>
<p>Based on pairs of user/item interactions, our goal is to find some sort of measure of user preferences to make predictions about what to recommend. For example, suppose we were interested in seeing how Netflix users can rate items (movies) on a scale from ‚ÄúNot for me‚Äù, ‚ÄúI like this‚Äù, ‚ÄúLove this!‚Äù, which we will arbitrarily assign the values -1, 1, 2. We will use the value 0 to indicate a user hasn‚Äôt rated a movie.</p>
<table class="table" id="user-item-interactions">
<caption><span class="caption-number">Table 19.1 </span><span class="caption-text">Example Netflix ratings user-item interaction matrix</span><a class="headerlink" href="#user-item-interactions" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Item 1</p></th>
<th class="head"><p>Item 2</p></th>
<th class="head"><p>‚Ä¶</p></th>
<th class="head"><p>Item <span class="math notranslate nohighlight">\(m\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>User 1</strong></p></td>
<td><p>2</p></td>
<td><p>0</p></td>
<td><p>‚Ä¶</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p><strong>User 2</strong></p></td>
<td><p>0</p></td>
<td><p>-1</p></td>
<td><p>‚Ä¶</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>‚Ä¶</p></td>
<td><p>‚Ä¶</p></td>
<td><p>‚Ä¶</p></td>
<td><p>‚Ä¶</p></td>
<td><p>‚Ä¶</p></td>
</tr>
<tr class="row-odd"><td><p><strong>User <span class="math notranslate nohighlight">\(n\)</span></strong></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>‚Ä¶</p></td>
<td><p>0</p></td>
</tr>
</tbody>
</table>
<p>An important note is that what you choose to record and define interactions with users and items will have a tremendous impact on the model we learn and recommendations we make. Importantly, we should distinguish between two types of interactions we could record: <strong>implicit user feedback</strong> and <strong>explicit user feedback</strong>. Explicit feedback is when the user explicitly tells us if they like an item or not (e.g., Netflix users rating a movie as one they enjoyed or not) while implicit feedback are values we derive from their interaction with an item (e.g., did they go on to continue to use the service and watch more movies later). In different settings, we might care about different metrics for defining user interactions, and we will see the ramifications of the metrics we choose to measure.</p>
<p>Here are some example types of feedback that you could imagine gathering in various contexts. Note that there are multiple options for each application as we might care to optimize for different types of user feedback depending on context.</p>
<table class="table" id="recommender-metrics">
<caption><span class="caption-number">Table 19.2 </span><span class="caption-text">Example metrics for measuring user-item interactions</span><a class="headerlink" href="#recommender-metrics" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Application</p></th>
<th class="head"><p>Users</p></th>
<th class="head"><p>Items</p></th>
<th class="head"><p>Metric</p></th>
<th class="head"><p>Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Netflix</p></td>
<td><p>Subscribers</p></td>
<td><p>Movies/Shows</p></td>
<td><p>Rating</p></td>
<td><p>Explicit</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p>Watch time</p></td>
<td><p>Implicit</p></td>
</tr>
<tr class="row-even"><td><p>TikTok</p></td>
<td><p>Users</p></td>
<td><p>Videos</p></td>
<td><p>Hearted video</p></td>
<td><p>Explicit</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p>Followed creator</p></td>
<td><p>Explicit</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p>Watch time</p></td>
<td><p>Implicit</p></td>
</tr>
<tr class="row-odd"><td><p>Amazon</p></td>
<td><p>Customers</p></td>
<td><p>Products</p></td>
<td><p>Purchased</p></td>
<td><p>Explicit</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p>Clicking on product</p></td>
<td><p>Implicit</p></td>
</tr>
</tbody>
</table>
<p>It‚Äôs important to highlight the role that the metric we choose to optimize recommendations for, and the effects that has on our system. Most real-world systems might combine many of these metrics in a complex way. Specifically in cases of implicit feedback, these metrics are often proxies that might not align with the users‚Äô actual preferences. For example, a recommendation system in Youtube to maximize watch time might not recommend content the user enjoys or will benefit from, but the most addicting content to get them to stay on the system longer. We will discuss the impacts the choice in metric we care to measure later on in the chapter.</p>
<p>The general learning task for recommender systems is: Given a user <span class="math notranslate nohighlight">\(u\)</span>, recommend <span class="math notranslate nohighlight">\(k\)</span> items <span class="math notranslate nohighlight">\(\{v_1, v_2, ... v_k\}\)</span> that the user will prefer the most (according to our metric recorded in interaction data). Some recommender systems use outside information about the user (e.g., information provided in their profile or inferred from other sources), while others work directly with this user-item interaction exclusively. A special case is with <span class="math notranslate nohighlight">\(k=1\)</span>, where recommend a single item, but many systems use some small <span class="math notranslate nohighlight">\(k\)</span> to recommend a set of items.</p>
<div class="note admonition">
<p class="admonition-title">General Discussion</p>
<p>We will note that all of the specific algorithms we will mention in this chapter are fairly generally, but probably not used exactly as described in practice for real systems. The reason being, more often than not, a good recommendation algorithm is <strong><em>the</em></strong> secret-sauce for making a company‚Äôs product successful. For example, TikTok is commonly cited as booming in the social media space because of its incredibly sophisticated recommendation algorithm to recommend videos without much explicit feedback. Naturally, many companies use a lot of tricks and techniques they do not share with the public to keep that secret-sauce, well, secret.</p>
<p>However, that doesn‚Äôt mean there isn‚Äôt anything to discuss! There are a lot of common themes for design choices across various recommendation systems, and our goal is to try to give an overview of ‚Äúcanonical‚Äù methods and discuss their tradeoffs. Yes, most deployed models will be different in a myriad of ways from the foundational algorithms we describe, but understanding the choices and tradeoffs between different styles of recommender systems is useful in determining the choices you will want to make in your own systems.</p>
</div>
<p>In most contexts, this user-item interactions matrix we record in our system is incredibly sparse: users interact with a tiny minority of the total content on the system. This poses a challenge in that for each user, we have a tiny fraction of possible interactions to work from.</p>
</section>
<section id="approach-1-popularity-recommendations">
<h2><span class="section-number">19.2. </span>Approach 1: Popularity Recommendations<a class="headerlink" href="#approach-1-popularity-recommendations" title="Permalink to this heading">#</a></h2>
<div class="admonition-tags admonition">
<p class="admonition-title">Tags</p>
<ul class="simple">
<li><p>Collaborative Filtering</p></li>
</ul>
</div>
<p>Perhaps the simplest approach to a recommender system that handles this sparsity problem is the <strong>popularity model</strong>. When we want to recommend an item (or set of items) for a user, we simply recommend what is globally popular in the system. That is, we completely ignore the concept of a input of a user <span class="math notranslate nohighlight">\(u\)</span>, and recommend everyone the items that are globally most popular.</p>
<p>We can accomplish this by taking our user-item interaction matrix and summing across the rows to get a ‚Äútotal interaction‚Äù across all users. A sum is appropriate here instead of an average since we are intentionally trying to hype-up items that are popular across all users, rather than items that have a high average interaction from a single user really liking that one item. Usually we have added logic to avoid recommending an item that the user has already interacted with, but that is an optional implementation detail.</p>
<figure class="align-center" id="id2">
<img alt="Steps describing summing over all users" src="../../_images/popularity.png" />
<figcaption>
<p><span class="caption-number">Fig. 19.2 </span><span class="caption-text">Popularity Model (edited from <a class="reference external" href="https://towardsdatascience.com/introduction-to-recommender-systems-6c66cf15ada">source</a>)</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Let‚Äôs consider the pros and cons of a model such as this one for a recommender system. We will go through this exercise for all of the models we introduce to get a sense of their benefits and limitations. Each of these sections will ask you to pause and think about the pros and cons before reading our descriptions. Expand the boxes after taking some time to think of some benefits and downsides before moving on.</p>
<div class="tip dropdown admonition">
<p class="admonition-title"><strong>Pros</strong></p>
<ul class="simple">
<li><p>Incredibly simple to describe and implement.</p></li>
<li><p>While partially a con as we will describe in the next dropdown, the fact that the popularity model doesn‚Äôt personalize to each user can sometimes be seen as a benefit in a couple of scenarios. Two that come to mind are:</p>
<ol class="arabic simple">
<li><p>When you first launch your application, you might not have enough data to make a more nuanced recommender system so it can be a decent starter-system to gather data initially before you can build something more complex.</p></li>
<li><p>Many of our recommender systems will suffer from what is called the <em>cold-start</em> problem, where it‚Äôs not clear what to recommend when a new user or item enters the system. Since there is no personalization to the user, we naturally avoid the cold-start problem of not knowing what to recommend a newly-joined user.</p></li>
</ol>
</li>
</ul>
</div>
<div class="error dropdown admonition">
<p class="admonition-title"><strong>Cons</strong></p>
<ul class="simple">
<li><p>Clearly, the popularity model doesn‚Äôt take into account a particular user‚Äôs preferences at all. This extremely limits the recommender system since it cannot recommend anything more personal for a user.</p></li>
<li><p>A popularity model is very susceptible to feedback loops, where its recommendations form a self-fulfilling prophecy that further reinforces the popularity of the items it recommends. If it only recommends popular content, then people will continue to watch that content, further increasing its popularity and making it more likely to be recommended in the future.</p></li>
<li><p>Top-k recommendations can potentially be very redundant. For example, when a new Hunger Games movie comes out, the other movies tend to surge in popularity. In some cases, for extremely popular series, this can lead to a lack of diversity of items in the recommendations since, as we mentioned, popular content tends to get more popular in these popularity model systems.</p></li>
</ul>
</div>
<p>The point we made above about <strong>feedback loops</strong> is important enough to highlight in the main text. In every recommender system we will discuss, the concept of a feedback loop will be present and important to consider. Broadly, a feedback loop results when the recommendations or outputs of the model will affect the future inputs of that model, potentially leading to cascading unintentional consequences. Earlier, we saw the non-recommendation system context of feedback loops in predictive policing and how predictions of increase crime lead to more police being deployed there, thus catching more (nuisance) crimes and justifying even more policing in those neighborhoods. Feedback loops are almost always unintentional consequences of the model using its outputs as inputs. But these cases are essentially unavoidable in most real world systems. Consider how almost the entirety of TikTok‚Äôs success relies on the recommendations it makes driving the vast majority of user interactions. While feedback loops are essentially unavoidable, that doesn‚Äôt mean we shouldn‚Äôt try to build safeguards in our systems to mitigate their impacts.</p>
</section>
<section id="approach-2-nearest-users">
<h2><span class="section-number">19.3. </span>Approach 2: Nearest Users<a class="headerlink" href="#approach-2-nearest-users" title="Permalink to this heading">#</a></h2>
<div class="admonition-tags admonition">
<p class="admonition-title">Tags</p>
<ul class="simple">
<li><p>Collaborative Filtering: User-User</p></li>
</ul>
</div>
<p>To add personalization to our recommender system, we consider an alternative model that uses our trusty k-nearest neighbor (kNN) algorithm to make recommendations for a user based on similar users. Given a user <span class="math notranslate nohighlight">\(u_i\)</span>, compute their <span class="math notranslate nohighlight">\(K\)</span> nearest neighbors (note capital <span class="math notranslate nohighlight">\(K\)</span>) in the system, and recommend the <span class="math notranslate nohighlight">\(k\)</span> items (note lower <span class="math notranslate nohighlight">\(k\)</span>) that have the highest interactions amongst those <span class="math notranslate nohighlight">\(K\)</span> users.</p>
<figure class="align-center" id="id3">
<img alt="Steps describing finding the K nearest neighbors and then recommend their most popular items" src="../../_images/knn.png" />
<figcaption>
<p><span class="caption-number">Fig. 19.3 </span><span class="caption-text">Nearest Users (<a class="reference external" href="https://towardsdatascience.com/introduction-to-recommender-systems-6c66cf15ada">source</a>)</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Let‚Äôs consider the pros and cons of a model such as this one for a recommender system. Expand the boxes after taking some time to think of some benefits and downsides before moving on.</p>
<div class="tip dropdown admonition">
<p class="admonition-title"><strong>Pros</strong></p>
<ul class="simple">
<li><p>Pretty easy to describe and implement</p></li>
<li><p>Adds personalization! You will get tailored recommendations based on users like you!</p></li>
</ul>
</div>
<div class="error dropdown admonition">
<p class="admonition-title"><strong>Cons</strong></p>
<ul class="simple">
<li><p>Nearest neighbors might be a bit too similar, and limit the ability to make diverse recommendations. For example, if you and your nearest neighbors have interacted with only the same subset of content, then we can‚Äôt really make any meaningful recommendations. This technique relies on your nearest neighbors being similar, but not exactly the same as you. This is possible to fall apart in settings when there are far fewer users than content (potentially only interacting with content previously recommended to you as well).</p></li>
<li><p>This technique also creates its own feedback loop. In particular, it can lead to <em>echo chambers</em> where users are siloed off to their own subsets of content. This is increasingly a challenge in many online systems that have resulted in the radicalization of certain subgroups due to only being exposed by their interaction with that radicalizing content (think reinforcing behaviors of conspiracy theory groups).</p></li>
<li><p>These systems have the same scalability challenges that k-NN has in general. Prediction time is slower (unless using approximate methods) since you have to search over the whole dataset every time you want to make a prediction.</p>
<ul>
<li><p>Also suffers from the curse of dimensionality since every user is represented in <em>item-space</em> (<span class="math notranslate nohighlight">\(u_i \in \mathbb{R}^m\)</span> where <span class="math notranslate nohighlight">\(m\)</span> is the number of items).</p></li>
</ul>
</li>
<li><p>The cold-start problem affects this model when new users are added to the system. If you just joined, who should we define your nearest neighbors to be if we have no data to base your similarity to other users on. This will be a common challenge with most of our recommender systems.</p></li>
</ul>
</div>
</section>
<section id="approach-3-people-who-bought-this-also-bought">
<h2><span class="section-number">19.4. </span>Approach 3: ‚ÄúPeople who bought this also bought‚Ä¶‚Äù<a class="headerlink" href="#approach-3-people-who-bought-this-also-bought" title="Permalink to this heading">#</a></h2>
<div class="admonition-tags admonition">
<p class="admonition-title">Tags</p>
<ul class="simple">
<li><p>Collaborative Filtering: Item-Item</p></li>
</ul>
</div>
<p>A slightly different approach is to focus on the similarity of items rather than the similarity of users. A potential item-item recommender system is designed to fill in the blank of the sentence ‚ÄúUsers who bought this, also bought‚Ä¶‚Äù</p>
<figure class="align-center" id="id4">
<img alt="Amazon's &quot;Frequently bought together&quot; section for 'Cracking the Coding Interview'" src="../../_images/item-item.png" />
<figcaption>
<p><span class="caption-number">Fig. 19.4 </span><span class="caption-text">Amazon‚Äôs Item-Item recommendations of ‚ÄúFrequently bought together‚Äù</span><a class="headerlink" href="#id4" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>One way of implementing this model is to consider the <strong>co-occurrence matrix</strong> <span class="math notranslate nohighlight">\(C \in \mathbb{R}^{m \times m}\)</span> where <span class="math notranslate nohighlight">\(m\)</span> is the number of items in the system. Each entry <span class="math notranslate nohighlight">\(C_{i,j}\)</span> counts the number of users who bought both item <span class="math notranslate nohighlight">\(i\)</span> and item <span class="math notranslate nohighlight">\(j\)</span>. Note that <span class="math notranslate nohighlight">\(C_{i,i}\)</span>  is the total number of users who bought item <span class="math notranslate nohighlight">\(i\)</span>. For the recommendation task, we are given an item <span class="math notranslate nohighlight">\(i\)</span> and can predict the top-<span class="math notranslate nohighlight">\(k\)</span> items that are bought together with item <span class="math notranslate nohighlight">\(i\)</span> (usually excluding <span class="math notranslate nohighlight">\(i\)</span> as an option).</p>
<figure class="align-center" id="id5">
<img alt="A matrix showing counts of example items bought together" src="../../_images/co-occurrence.png" />
<figcaption>
<p><span class="caption-number">Fig. 19.5 </span><span class="caption-text">A co-occurrence matrix for items (<span class="math notranslate nohighlight">\(C \in \mathbb{R}^{m \times m}\)</span>)</span><a class="headerlink" href="#id5" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>One difficulty that arises with a co-occurrence matrix like t his is that globally popular items will drown out items since their counts are naturally larger. One solution that ignores the global popularity of items and makes item recommendations more specific to the input item is to scale all of the counts. One common scaling is the <strong>Jaccard Similarity</strong> we described earlier. The scaled co-occurrence matrix <span class="math notranslate nohighlight">\(S\)</span> can be found with</p>
<div class="math notranslate nohighlight">
\[S_{i, j} = \frac{\text{# purchased}\ i\ \textbf{and}\ j}{\text{# purchased}\ i\ \textbf{or}\ j} = \frac{C_{i, j}}{C_{i,i} + C_{j,j} - C_{i, j}}\]</div>
<p>Below we show the same co-occurrence matrix data but scaled with the Jaccard Similarity.</p>
<figure class="align-center" id="id6">
<img alt="A matrix showing counts of example items bought together scaled by Jaccard similarity" src="../../_images/jaccard-co-occurrence.png" />
<figcaption>
<p><span class="caption-number">Fig. 19.6 </span><span class="caption-text">A co-occurrence matrix for items scaled with Jaccard Similarity (<span class="math notranslate nohighlight">\(S \in \mathbb{R}^{m \times m}\)</span>)</span><a class="headerlink" href="#id6" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>It is also possible to augment this procedure to explicitly add user personalization by incorporating their interaction history in the average. Instead of reporting the items that have the highest co-occurrence, we can compute a score for each user and an item based on their history. For example, if we know a user has only bought a baby bottle and baby formula, we could incorporate that to only use those in the computation for a score for each item. In this example, we could define the score for a user and the item ‚Äúdiapers‚Äù as follows (assuming they have only bought a baby bottle and baby formula).</p>
<div class="math notranslate nohighlight">
\[Score(u, v=\text{diapers}) = \frac{S_{diapers, baby bottle}}{2} + \frac{S_{diapers, baby formula}}{2}\]</div>
<p>Our recommendation algorithm could then return the <span class="math notranslate nohighlight">\(k\)</span> items with the highest average score. As an additional implementation detail, you could also do a weighted average to put more weights on recent purchases.</p>
<p>Let‚Äôs consider the pros and cons of these approaches.</p>
<div class="tip dropdown admonition">
<p class="admonition-title"><strong>Pros</strong></p>
<ul class="simple">
<li><p>Provides personalization based on the item the user is looking at. Can also add personalization to the user by incorporating and adding more weight on the user‚Äôs previous interactions.</p></li>
<li><p>Slightly more scalable than Nearest User in many real-world settings since we often assume the <span class="math notranslate nohighlight">\(n \gg m\)</span>. Representing a <span class="math notranslate nohighlight">\(\mathbb{m \times m}\)</span> matrix is generally more efficient than our <span class="math notranslate nohighlight">\(\mathbb{R}^{n \times m}\)</span> matrix for Nearest User.</p></li>
</ul>
</div>
<div class="error dropdown admonition">
<p class="admonition-title"><strong>Cons</strong></p>
<ul class="simple">
<li><p>Still suffers from feedback loops, in that it generally recommends items that are globally popular since they are more frequently bought with other items.</p></li>
<li><p>Still has some scalability issues. While better than Nearest User in terms of memory requirements, storing the whole item-item matrix is quite expensive in real-world settings.</p></li>
<li><p>Suffers from the cold-start problem, but when new <em>items</em> are added to the system.</p></li>
</ul>
</div>
</section>
<section id="approach-4-feature-based-approaches">
<h2><span class="section-number">19.5. </span>Approach 4: Feature-Based Approaches<a class="headerlink" href="#approach-4-feature-based-approaches" title="Permalink to this heading">#</a></h2>
<div class="admonition-tags admonition">
<p class="admonition-title">Tags</p>
<ul class="simple">
<li><p>Feature-Based or Content-Based</p></li>
</ul>
</div>
<p><em>Also referred to as content-based approaches</em></p>
<p>One common limitations of the models we discussed earlier is they rely solely on information from the user-item interaction matrix and do not use any extra information in their predictions. What if we tried to also include standard machine learning approaches we have discussed in this book to make a model to make predictions based on features we derive about the user and/or items?</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>1. Recall you would need to handle categorical features with something like a one-hot encoding.</p>
</aside>
<p>For example, we can create a feature vector <span class="math notranslate nohighlight">\(h(v)\)</span> for each item in the catalogue that describes various attributes of each item<sup>1. For simplicity, let‚Äôs ignore personalization to a user and form a global model of interactions with an item based on its features.</p>
<table class="table" id="id7">
<caption><span class="caption-number">Table 19.3 </span><span class="caption-text">Example features for a Movie catalogue</span><a class="headerlink" href="#id7" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Genre</p></th>
<th class="head"><p>Year</p></th>
<th class="head"><p>Director</p></th>
<th class="head"><p>‚Ä¶</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Action</p></td>
<td><p>1994</p></td>
<td><p>Quentin Tarantino</p></td>
<td><p>‚Ä¶</p></td>
</tr>
<tr class="row-odd"><td><p>Sci-Fi</p></td>
<td><p>1977</p></td>
<td><p>George Lucas</p></td>
<td><p>‚Ä¶</p></td>
</tr>
<tr class="row-even"><td><p>Drama</p></td>
<td><p>2017</p></td>
<td><p>Greta Gerwig</p></td>
<td><p>‚Ä¶</p></td>
</tr>
</tbody>
</table>
<p>Assuming our feature vector is <span class="math notranslate nohighlight">\(d\)</span>-dimensional (<span class="math notranslate nohighlight">\(h(v) \in \mathbb{R}^d\)</span>), then we can learn some sort of global model to make predictions about interactions with that item. For simplicity, let‚Äôs assume we are using a linear model, but more complex models could also be used. In that case we now need to learn coefficients for our model</p>
<div class="math notranslate nohighlight">
\[w_G \in \mathbb{R^d}\]</div>
<p>Which can do with a modified version of our OLS problem that minimizes squared error across the (user, item) pairs we have interaction data for. We use the notation <span class="math notranslate nohighlight">\(u, v\)</span> to be a pair of user/item, <span class="math notranslate nohighlight">\(r_{u,v}\)</span> to indicate the interaction metric for that user and that item, and <span class="math notranslate nohighlight">\(r{u,v} = ?\)</span> if the user has not interacted with that item. We can additionally add regularization to our model to instead of using plain OLS, using some sort of regularized regression of our choosing.</p>
<div class="math notranslate nohighlight">
\[\hat{w}_G = \argmin{w_G} \frac{1}{\text{# ratings}} \sum_{u, v:\ r_{u,v} \neq ?} \left( w_G^T h(v) - r_{u, v}\right)^2 + \lambda \norm{w_G}\]</div>
<p>Note that a major limitation of this global model is it can‚Äôt take into account user-specific preferences for certain items. However, we can modify this model to account for that in a couple of ways.</p>
<p>The first way is to include user-specific features in our data and learn coefficients for those as well. So for example, we might have the following dataset of item features and user features.</p>
<table class="table" id="id8">
<caption><span class="caption-number">Table 19.4 </span><span class="caption-text">Example features for a Movie catalogue with User features and Item features</span><a class="headerlink" href="#id8" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Genre</p></th>
<th class="head"><p>Year</p></th>
<th class="head"><p>Director</p></th>
<th class="head"><p>‚Ä¶</p></th>
<th class="head"><p>Gender</p></th>
<th class="head"><p>Age</p></th>
<th class="head"><p>‚Ä¶</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Action</p></td>
<td><p>1994</p></td>
<td><p>Quentin Tarantino</p></td>
<td><p>‚Ä¶</p></td>
<td><p>F</p></td>
<td><p>25</p></td>
<td><p>‚Ä¶</p></td>
</tr>
<tr class="row-odd"><td><p>Sci-Fi</p></td>
<td><p>1977</p></td>
<td><p>George Lucas</p></td>
<td><p>‚Ä¶</p></td>
<td><p>M</p></td>
<td><p>42</p></td>
<td><p>‚Ä¶</p></td>
</tr>
<tr class="row-even"><td><p>Drama</p></td>
<td><p>2017</p></td>
<td><p>Greta Gerwig</p></td>
<td><p>‚Ä¶</p></td>
<td><p>M</p></td>
<td><p>22</p></td>
<td><p>‚Ä¶</p></td>
</tr>
</tbody>
</table>
<p>We would represent this new set of features as a combination of both user features and item features <span class="math notranslate nohighlight">\(h(u, v)\)</span>. Our global model would now be the following, noting that we change all of our dimensions for <span class="math notranslate nohighlight">\(w_G \in \mathbb{R}^{d_1 + d_2}\)</span> where <span class="math notranslate nohighlight">\(d_1\)</span> is the number of user features and <span class="math notranslate nohighlight">\(d_2\)</span> the number of item features.</p>
<div class="math notranslate nohighlight">
\[\hat{r}_{u, v} = \hat{w}_G^Th(u, v)\]</div>
<p>While this approach is the simplest way to include user features, it tends to not be used in practice because it suffers from the cold start problem. What feature values for the user-features do we use for a brand-new user that signs up for the service if we don‚Äôt have that information yet?</p>
<p>We can actually avoid this user cold-start problem by changing our learning task just slightly. Instead of including user-specific features into our global model, we will restrict our model to only using item-specific features. But to learn personalization for the user, we will mix in a user-specific model the predictions for the global model. One such example is called a <strong>Linear Mixed Model</strong> or <strong>Linear Mixed Effects</strong> that combines the results of two different models in a linear fashion. We will learn our global model <span class="math notranslate nohighlight">\(\hat{w}_G\)</span> that takes item features <span class="math notranslate nohighlight">\(h(v)\)</span> to make predictions. On top of this, we will also learn a user-specific model <span class="math notranslate nohighlight">\(\hat{w}_u\)</span> that works of the same set of features, but makes predictions tailored to that user <span class="math notranslate nohighlight">\(u\)</span>. Then, our overall prediction for <span class="math notranslate nohighlight">\(\hat{r}_{u, v}\)</span> is as follows.</p>
<div class="math notranslate nohighlight">
\[\hat{r}_{u,v} = \left( \hat{w}_G + \hat{w}_u\right)^T h(v)\]</div>
<p>You can think of this as modifying the global model to have coefficients that are more tailored to the individual user <span class="math notranslate nohighlight">\(u\)</span>. When a new user joins, we can simply set <span class="math notranslate nohighlight">\(\hat{w}_u = 0\)</span> and provide no personalization to start. As the user interacts with more and more items, we can continuously update their coefficients to provide more tailored results. Some practical details for how we can train this user-specific model <span class="math notranslate nohighlight">\(\hat{w}_u\)</span>:</p>
<ul class="simple">
<li><p>We don‚Äôt have to retrain the user-model from scratch, but instead can train it on the mistakes or residuals of the global model. This is a slight simplification of the task to essentially finding the deviation of the user from the global ‚Äúaverage‚Äù user rather than learning their coefficients from scratch every time.</p></li>
<li><p>We can do more complicated Bayesian-style updates that start of deviations from the global model to be small, and allow them to get larger and larger as we are more confident in a user‚Äôs history.</p></li>
</ul>
<p>Again, let us consider the pros/cons of this feature-based approach.</p>
<div class="tip dropdown admonition">
<p class="admonition-title"><strong>Pros</strong></p>
<ul class="simple">
<li><p>No cold start problem! As described, the user-deviation approach allows us to make global recommendations for new users. We will note that this discussion has assumed the item-features are provided, but this is a common assumption in that items are often approved in the app or uploaded with a set of known features. For example, in TikTok creators uploading videos tag the video for TikTok about the contents and topics of the video.</p></li>
<li><p>It provides personalization based on the user‚Äôs characteristics and the item‚Äôs characteristics.</p></li>
<li><p>Extremely scalable since we only need to store the global model weights and user-specific model weights.</p></li>
<li><p>You can add as arbitrarily complicated features as you want to your model. For example, you might know that user preferences change throughout the day or based on the time of year. You can include those as features in your model to hopefully learn more complex macro-trends in preferences.</p></li>
</ul>
</div>
<div class="error dropdown admonition">
<p class="admonition-title"><strong>Cons</strong></p>
<ul class="simple">
<li><p>By far the biggest downside of this model is it requires a <em>lot</em> of manual work. Defining which features to include and why is challenging, and in many settings getting quality data for each user and item is quite difficult. So unless you have high quality data sources that can predict user preferences well, these approaches might just be less accurate than more simple approaches we discussed earlier.</p></li>
</ul>
</div>
</section>
<section id="approach-5-matrix-factorization">
<h2><span class="section-number">19.6. </span>Approach 5: Matrix Factorization<a class="headerlink" href="#approach-5-matrix-factorization" title="Permalink to this heading">#</a></h2>
<div class="admonition-tags admonition">
<p class="admonition-title">Tags</p>
<ul class="simple">
<li><p>Collaborative Filtering: Model Based</p></li>
</ul>
</div>
<p>Coming soon</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./recommender_systems/recommendation"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../pca/index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">18. </span><i class="fas fa-book fa-fw"></i> Dimensionality Reduction (coming soon)</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recommendation-framework">19.1. Recommendation Framework</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-1-popularity-recommendations">19.2. Approach 1: Popularity Recommendations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-2-nearest-users">19.3. Approach 2: Nearest Users</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-3-people-who-bought-this-also-bought">19.4. Approach 3: ‚ÄúPeople who bought this also bought‚Ä¶‚Äù</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-4-feature-based-approaches">19.5. Approach 4: Feature-Based Approaches</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-5-matrix-factorization">19.6. Approach 5: Matrix Factorization</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hunter Schafer
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div style="float: right">
  <!-- 100% privacy friendly analytics -->
  <script async defer src="https://scripts.simpleanalyticscdn.com/latest.js"></script>
  <noscript><img src="https://queue.simpleanalyticscdn.com/noscript.gif" alt="" referrerpolicy="no-referrer-when-downgrade" /></noscript>
  <a href="https://simpleanalytics.com/?utm_source=&utm_content=badge" referrerpolicy="origin" target="_blank"><picture><source srcset="https://simpleanalyticsbadges.com/?mode=dark" media="(prefers-color-scheme: dark)" /><img src="https://simpleanalyticsbadges.com/?mode=light" loading="lazy" referrerpolicy="no-referrer" crossorigin="anonymous" /></picture></a>
</div>

<div>
  <p>
    Have feedback or spotted a bug? Please make a <a href="https://github.com/animlbook/AnIML/issues">GitHub issue</a>
    or contact <a href="https://homes.cs.washington.edu/~hschafer/">Hunter Schafer</a>!
  </p>
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>